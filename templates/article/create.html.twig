{% extends 'base.html.twig' %}

{% block title %}Créer un nouvel Article - Inner Garden{% endblock %}

{% block body %}
<div class="container my-5">
    <div class="row justify-content-center">
        {# Utilise la même taille de colonne que la page d'inscription pour une cohérence visuelle #}
        <div class="col-md-8 col-lg-6"> {# col-md-8 col-lg-6 pour que le formulaire ait plus de place #}
            <div class="p-4 shadow-sm rounded bg-light text-dark">
                <h1 class="h3 mb-3 text-center">Créer un nouvel Article</h1>
                {# ajouter ici un div pour les messages flash si base.html.twig ne les affiche pas #}
                <div id="form-messages" class="mb-3"></div>

                {# Display form errors #}
                {% if form.vars.errors|length > 0 %}
                    <div class="alert alert-danger">
                        {% for error in form.vars.errors %}
                            <p>{{ error.message }}</p>
                        {% endfor %}
                    </div>
                {% endif %}

                {{ form_start(form, {'attr': {'enctype': 'multipart/form-data'}}) }}
                    <div class="mb-3">
                        {{ form_row(form.title, {
                            'label': 'Titre de l\'article',
                            'attr': {
                                'class': 'form-control',
                                'placeholder': 'Ex: Mon voyage à Bali'
                            }
                        }) }}
                    </div>
                    <div class="mb-3">
                        {{ form_row(form.excerpt, {
                            'label': 'Extrait (court résumé pour la liste des articles)',
                            'attr': {
                                'class': 'form-control',
                                'rows': 3,
                                'placeholder': 'Un bref aperçu du contenu de l\'article...'
                            }
                        }) }}
                    </div>
                    <div class="mb-3">
                        {{ form_row(form.content, {
                            'label': 'Contenu de l\'article',
                            'attr': {
                                'class': 'form-control',
                                'rows': 15,
                                'placeholder': 'Commencez à écrire votre article ici...'
                            }
                        }) }}
                    </div>
                    <div class="mb-3">
                        {{ form_row(form.category, {
                            'label': 'Catégorie',
                            'attr': {'class': 'form-select'},
                            'placeholder': 'Choisissez une catégorie'
                        }) }}
                    </div>
                    <div class="mb-3">
                        {{ form_row(form.author, {
                            'label': 'Auteur',
                            'attr': {'class': 'form-select'},
                            'placeholder': 'Choisissez un auteur'
                        }) }}
                    </div>
                    <div class="mb-3">
                        {{ form_row(form.imageFile, {
                            'label': 'Image de l\'article (format JPG, PNG, GIF)',
                            'attr': {'class': 'form-control'},
                            'help': 'Taille maximale recommandée : 2 Mo'
                        }) }}
                    </div>
                    <div class="mb-3 form-check">
                        {{ form_row(form.isPublished, {
                            'label': 'Publier l\'article immédiatement',
                            'attr': {'class': 'form-check-input'}
                        }) }}
                    </div>
                    <div class="mb-3">
                        {{ form_row(form.publishedAt, {
                            'label': 'Date de publication programmée (optionnel)',
                            'attr': {
                                'class': 'form-control'
                            },
                            'help': 'Laissez vide pour publier immédiatement si "Publier" est coché, ou définissez une date future pour programmer la publication'
                        }) }}
                    </div>
                    <div class="mb-3">
                        {{ form_row(form.slug, {
                            'label': 'Slug (laisser vide pour générer automatiquement)',
                            'help': 'URL conviviale de l\'article (ex: mon-super-article)',
                            'attr': {
                                'class': 'form-control',
                                'placeholder': 'Laissez vide pour auto-générer'
                            }
                        }) }}
                    </div>

                    <br>
                    <div class="d-grid gap-2">
                        {# The submit button is added directly here #}
                        <button type="submit" class="btn btn-custom" id="submitButton">Créer l'article</button>
                        <a href="{{ path('articles_list') }}" class="btn btn-secondary">Annuler et Retour</a>
                    </div>
                    
                    {# Render any remaining form fields that weren't explicitly rendered #}
                    {{ form_rest(form) }}
                {{ form_end(form) }}
            </div>
        </div>
    </div>
</div>
{% endblock %}

{# scripts JS spécifiques pour ce formulaire#}
{% block javascripts %}
    {{ parent() }}
    {# <script src="{{ asset('js/article_form.js') }}"></script> #}
{% endblock %}